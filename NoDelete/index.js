(function(D,r,t,F,o,p,f,m,b,B){"use strict";t.storage.ignore??={users:[],bots:!1},t.storage.timestamps??=!1,t.storage.onlyTimestamps??=!1,t.storage.ew??=!1;function y(a){return F.useProxy(t.storage),r.React.createElement(r.ReactNative.ScrollView,{style:{flex:1}},r.React.createElement(o.Forms.FormSection,{title:"Settings",titleStyleType:"no_border"},[{label:"Show the time of deletion",setting:t.storage.timestamps,onChange(e){return t.storage.timestamps=e}},{label:"Use AM/PM",setting:t.storage.ew,onChange(e){return t.storage.ew=e}}].map(function(e){return r.React.createElement(o.Forms.FormRow,{label:e.label,trailing:r.React.createElement(o.Forms.FormSwitch,{value:e.setting,onValueChange:e.onChange})})}),r.React.createElement(o.Forms.FormLabel,{label:"The plugin does not keep the messages you've deleted"})),r.React.createElement(o.Forms.FormSection,{title:"Filters"},r.React.createElement(o.Forms.FormRow,{label:"Ignore bots",trailing:r.React.createElement(o.Forms.FormSwitch,{value:t.storage.ignore.bots,onValueChange:function(e){return t.storage.ignore.bots=e}})}),r.React.createElement(o.Forms.FormRow,{label:`Clear user ignore list (${t.storage.ignore.users.length})`,trailing:r.React.createElement(o.Forms.FormRow.Icon,{source:p.getAssetIDByName("ic_trash_24px")}),onPress:function(){t.storage.ignore.users=[],r.toasts.showToast("Successfully cleared")}})))}const l={optionLabels:[{"en-GB":"[NoDelete] Ignore deleted messages",uk:"[NoDelete] \u0406\u0433\u043D\u043E\u0440\u0443\u0432\u0430\u0442\u0438 \u0432\u0438\u0434\u0430\u043B\u0435\u043D\u0456 \u043F\u043E\u0432\u0456\u0434\u043E\u043C\u043B\u0435\u043D\u043D\u044F",ru:"[NoDelete] \u0418\u0433\u043D\u043E\u0440\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0443\u0434\u0430\u043B\u0435\u043D\u043D\u044B\u0435 \u0441\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u044F"},{"en-GB":"[NoDelete] Stop ignoring deleted messages",uk:"[NoDelete] \u041F\u0440\u0438\u043F\u0438\u043D\u0438\u0442\u0438 \u0456\u0433\u043D\u043E\u0440\u0443\u0432\u0430\u043D\u043D\u044F \u0432\u0438\u0434\u0430\u043B\u0435\u043D\u0438\u0445 \u043F\u043E\u0432\u0456\u0434\u043E\u043C\u043B\u0435\u043D\u043D\u044C",ru:"[NoDelete] \u041F\u0440\u0435\u043A\u0440\u0430\u0442\u0438\u0442\u044C \u0438\u0433\u043D\u043E\u0440\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u0435 \u0443\u0434\u0430\u043B\u0435\u043D\u043D\u044B\u0445 \u0441\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u0439"}],toastLabels:[{"en-GB":"Enabled ignoring deleted messages from ${user}",uk:"\u0423\u0432\u0456\u043C\u043A\u043D\u0435\u043D\u043E \u0456\u0433\u043D\u043E\u0440\u0443\u0432\u0430\u043D\u043D\u044F \u0432\u0438\u0434\u0430\u043B\u0435\u043D\u0438\u0445 \u043F\u043E\u0432\u0456\u0434\u043E\u043C\u043B\u0435\u043D\u044C \u0432\u0456\u0434 ${user}",ru:"\u0412\u043A\u043B\u044E\u0447\u0435\u043D\u043E \u0438\u0433\u043D\u043E\u0440\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u0435 \u0443\u0434\u0430\u043B\u0435\u043D\u043D\u044B\u0445 \u0441\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u0439 \u043E\u0442 ${user}"},{"en-GB":"Disabled ignoring deleted messages from ${user}",uk:"\u0412\u0438\u043C\u043A\u043D\u0435\u043D\u043E \u0456\u0433\u043D\u043E\u0440\u0443\u0432\u0430\u043D\u043D\u044F \u0432\u0438\u0434\u0430\u043B\u0435\u043D\u0438\u0445 \u043F\u043E\u0432\u0456\u0434\u043E\u043C\u043B\u0435\u043D\u044C \u0432\u0456\u0434 ${user}",ru:"\u0412\u044B\u043A\u043B\u044E\u0447\u0435\u043D\u043E \u0438\u0433\u043D\u043E\u0440\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u0435 \u0443\u0434\u0430\u043B\u0435\u043D\u043D\u044B\u0445 \u0441\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u0439 \u043E\u0442 ${user}"}],thisMessageWasDeleted:{"en-GB":"This message was deleted",uk:"\u0426\u0435 \u043F\u043E\u0432\u0456\u0434\u043E\u043C\u043B\u0435\u043D\u043D\u044F \u0431\u0443\u043B\u043E \u0432\u0438\u0434\u0430\u043B\u0435\u043D\u043E",ru:"\u042D\u0442\u043E \u0441\u043E\u043E\u0431\u0449\u0435\u043D\u0438\u0435 \u0431\u044B\u043B\u043E \u0443\u0434\u0430\u043B\u0435\u043D\u043E"}};let w="undefined";const S="en-GB";function i(a){let e=l;for(const u of a.split("."))e?.hasOwnProperty(u)?e=e[u]:e=l;return e===l?a:e[w]??e[S]??a}let E,c=[];var v={settings:y,patches:[],onUnload(){this.patches.forEach(function(a){return a()}),this.patches=[]},onLoad(){try{this.patches.push(f.before("dispatch",r.FluxDispatcher,function(e){try{E||(E=m.findByStoreName("MessageStore"));const u=e[0];if(!u||u?.type!=="MESSAGE_DELETE"||!u?.id||!u?.channelId)return;const s=E.getMessage(u.channelId,u.id);if(t.storage.ignore.users.includes(s?.author?.id)||t.storage.ignore.bots&&s?.author?.bot)return;if(c.includes(u.id))return c.splice(c.indexOf(u.id),1),e;c.push(u.id);let d=i("thisMessageWasDeleted");return t.storage.timestamps&&(d+=` (${r.moment().format(t.storage.ew?"hh:mm:ss.SS a":"HH:mm:ss.SS")})`),e[0]={type:"MESSAGE_EDIT_FAILED_AUTOMOD",messageData:{type:1,message:{channelId:u.channelId,messageId:u.id}},errorResponseBody:{code:2e5,message:d}},e}catch(u){console.error(u),alert(`[Nodelete \u2192 dispatcher patch] died
`+u.stack)}}));const a=f.before("render",m.findByProps("ScrollView").View,function(e){try{let u=b.findInReactTree(e,function(n){return n.key===".$UserProfileOverflow"});if(!u||!u.props||u.props.sheetKey!=="UserProfileOverflow")return;const s=u.props.content.props,d=l.optionLabels.map(Object.values).flat();if(s.options.some(function(n){return d.includes(n?.label)}))return;const h=Object.keys(u._owner.stateNode._keyChildMapping).find(function(n){return u._owner.stateNode._keyChildMapping[n]&&n.match(/(?<=\$UserProfile)\d+/)})?.slice?.(13);let g=+s.options?.[1]?.isDestructive;t.storage.ignore.users.includes(h)?(s.options?.[2]?.isDestructive&&g++,s.options.splice(g+1,0,{label:i("optionLabels.1"),onPress:function(){t.storage.ignore.users.splice(t.storage.ignore.users.findIndex(function(n){return n===h}),1),B.showToast(i("toastLabels.1").replaceAll("${user}",s.header.title)),s.hideActionSheet()}})):s.options.splice(g+1,0,{isDestructive:!0,label:i("optionLabels.0"),onPress:function(){t.storage.ignore.users.push(h),B.showToast(i("toastLabels.0").replaceAll("${user}",s.header.title)),s.hideActionSheet()}})}catch(u){console.error(u);let s=!1;try{s=a()}catch{s=!1}alert(`[NoDelete \u2192 context menu patch] failed. Patch ${s?"dis":"en"}abled
`+u.stack)}});this.patches.push(a)}catch(a){console.error(a),alert(`[NoDelete] dead
`+a.stack)}}};return D.default=v,Object.defineProperty(D,"__esModule",{value:!0}),D})({},vendetta.metro.common,vendetta.plugin,vendetta.storage,vendetta.ui.components,vendetta.ui.assets,vendetta.patcher,vendetta.metro,vendetta.utils,vendetta.ui.toasts);
