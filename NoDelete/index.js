(function(o,a,t,d,r,h,g){"use strict";t.storage.ignore??={users:[],bots:!1},t.storage.timestamps??=!1,t.storage.onlyTimestamps??=!1,t.storage.ew??=!1;function u(s){return d.useProxy(t.storage),a.React.createElement(a.ReactNative.ScrollView,{style:{flex:1}},[{type:"switch",label:"Show the time of deletion",setting:t.storage.timestamps,onChange(e){return this.setting=e}},{type:"switch",label:"Use AM/PM",setting:t.storage.ew,onChange(e){return this.setting=e}},{type:"separator"},{type:"switch",label:"Ignore bots",setting:t.storage.ignore.bots,onChange(e){return this.setting=e}},{type:"text",label:"The plugin does not keep the messages you've deleted"}].map(function(e){if(e.type==="switch")return a.React.createElement(r.Forms.FormRow,{label:e.label,trailing:a.React.createElement(r.Forms.FormSwitch,{value:e.setting,onValueChange:e.onChange})});if(e.type==="text")return a.React.createElement(r.Forms.FormLabel,{label:e.label});if(e.type==="separator")return a.React.createElement(r.Forms.FormDivider,null)}))}let i,n=[];var m={settings:u,patches:[],onUnload(){this.patches.forEach(function(s){return s()}),this.patches=[]},onLoad(){try{this.patches.push(h.before("dispatch",a.FluxDispatcher,function(s){try{i||(i=g.findByStoreName("MessageStore"));const e=s[0];if(!e||e?.type!=="MESSAGE_DELETE"||!e?.id||!e?.channelId)return;const l=i.getMessage(e.channelId,e.id);if(t.storage.ignore.users.includes(l?.author?.id)||t.storage.ignore.bots&&l?.author?.bot)return;if(n.includes(e.id))return n.splice(n.indexOf(e.id),1),s;n.push(e.id);let c=t.storage.message||"This message was deleted";return t.storage.timestamps&&(c+=` (${a.moment().format(t.storage.ew?"hh:mm:ss.SS a":"HH:mm:ss.SS")})`),s[0]={type:"MESSAGE_EDIT_FAILED_AUTOMOD",messageData:{type:1,message:{channelId:e.channelId,messageId:e.id}},errorResponseBody:{code:2e5,message:c}},s}catch(e){console.error(e),alert(`[Nodelete \u2192 patch] died
`+e.stack)}}))}catch(s){console.error(s),alert(`[NoDelete] dead
`+s.stack)}}};return o.default=m,Object.defineProperty(o,"__esModule",{value:!0}),o})({},vendetta.metro.common,vendetta.plugin,vendetta.storage,vendetta.ui.components,vendetta.patcher,vendetta.metro);
