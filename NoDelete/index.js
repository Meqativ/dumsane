(function(a){"use strict";const{React:i,ReactNative:u}=vendetta.metro.common,{plugin:{storage:r},storage:{useProxy:d},ui:{components:{Forms:m}}}=vendetta;"timestamps"in r||(r.timestamps=!1);const{FormRow:g,FormSection:b,FormSwitch:h}=m;function p(n){return d(r),i.createElement(u.ScrollView,{style:{flex:1}},[{label:"Show the time of deletion",default:!1,id:"timestamps"},{label:"Use AM/PM",default:!1,id:"ew"},{label:"The plugin does not keep the messages you've deleted"}].map(function(e){return i.createElement(g,{label:e.label,trailing:"id"in e?i.createElement(h,{value:r[e.id]??e.default,onValueChange:function(t){return r[e.id]=t}}):void 0})}))}let s=[];const f={settings:p,onLoad(){try{const{plugin:{storage:n}}=vendetta,{FluxDispatcher:e}=vendetta.metro.common,t=vendetta.metro.findByStoreName("UserStore").getCurrentUser;this?.onUnload?.(),t()?this.run("meow"):e.subscribe("CONNECTION_OPEN",run)}catch(n){alert(n.stack),console.error(n)}},run(n){try{n!=="meow"&&FluxDispatcher.unsubscribe(run),currentUser||(currentUser=getCurrentUser());const e=currentUser.id==="744276454946242723";this.onUnload=vendetta.patcher.before("dispatch",vendetta.metro.common.FluxDispatcher,function(t){const l=window?.debugpls===!0||e===!0&&window?.debugpls!==!1,[o]=t;if(o.type==="MESSAGE_DELETE"){if(s.includes(o.id))return delete s[s.indexOf(o.id)],t;s.push(o.id);let c="This message was deleted";return storage.timestamps&&(c+=` (${vendetta.metro.common.moment().format(storage.ew?"hh:mm:ss.SS a":"HH:mm:ss.SS")})`),l&&console.log("[NoDelete \u203A before]",t),t[0]={type:"MESSAGE_EDIT_FAILED_AUTOMOD",messageData:{type:1,message:{channelId:o.channelId,messageId:o.id}},errorResponseBody:{code:2e5,message:c}},l&&console.log("[NoDelete \u203A after]",t),t}})}catch(e){alert(e.stack),console.error(e)}}};return a.default=f,Object.defineProperty(a,"__esModule",{value:!0}),a})({});
