(function(p,M,A,l,B,C,N,U){"use strict";function k(n,s,a){if(!n?.name||!n?.description)throw new Error(`No name(${n?.name}) or description(${n?.description}) in the passed command (command name: ${n?.name})`);if(n.displayName??=s?.names?.[a]??n.name,n.displayDescription??=s?.names?.[a]??n.description,n.options){if(!Array.isArray(n.options))throw new Error(`Options is not an array (received: ${typeof n.options})`);for(var r=0;r<n.options.length;r++){const e=n.options[r];if(!e?.name||!e?.description)throw new Error(`No name(${e?.name}) or description(${e?.description} in the option with index ${r}`);if(e.displayName??=s?.options?.[r]?.names?.[a]??e.name,e.displayDescription??=s?.options?.[r]?.descriptions?.[a]??e.description,e?.choices){if(!Array.isArray(e?.choices))throw new Error(`Choices is not an array (received: ${typeof e.choices})`);for(var t=0;t<e.choices.length;t++){const o=e.choices[t];if(!o?.name)throw new Error(`No name of choice with index ${t} in option with index ${r}`);o.displayName??=s?.options?.[r]?.choices?.[t]?.names?.[a]??o.name}}}}return n}function $(n){const{metro:{findByProps:s,findByStoreName:a,common:{lodash:{merge:r}}}}=n,{sendMessage:t,receiveMessage:e}=s("sendMessage","receiveMessage"),{createBotMessage:o}=s("createBotMessage"),h=s("BOT_AVATARS"),{getChannelId:u}=a("SelectedChannelStore");return function(i,c){if(i.channelId??=u(),[null,void 0].includes(i.channelId))throw new Error("No channel id to receive the message into (channelId)");let d=i;return i.really?(typeof c=="object"&&(d=r(d,c)),t(i.channelId,d)):(c!==!0&&(d=o(d)),typeof c=="object"&&(d=r(d,c),"author"in c&&function(){const g=c.author;["avatar","avatarURL"].every(function(R){return R in g})&&(h.BOT_AVATARS[g.avatar]=g.avatarURL,delete g.avatarURL)}()),e(d.channel_id,d),d)}}const v={getLoading(){return Math.random()<.01?this.aol:this.loadingDiscordSpinner},getFailure(){return Math.random()<.01?this.fuckyoy:this.linuth},getSuccess(){return""},loadingDiscordSpinner:"a:loading:1105495814073229393",aol:"a:aol:1108834296359301161",linuth:":linuth:1110531631409811547",fuckyoy:":fuckyoy:1108360628302782564"},b={command:"https://cdn.discordapp.com/attachments/1099116247364407337/1112129955053187203/command.png"},T="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",S=T.replace("+/","_-");function E(n,s){if(typeof n!="number")throw new Error(`Passed data isn't a number (received: ${typeof n})`);let a="";for(;n>0;)a=(s?S:T).charAt(n%64)+a,n=Math.floor(n/64);return a}const{meta:{resolveSemanticColor:P}}=l.findByProps("colors","meta"),O=l.findByStoreName("ThemeStore"),m=function(){return parseInt(P(O.theme,M.semanticColors.BACKGROUND_SECONDARY).slice(1),16)},f={author:{username:"TokenUtils",avatar:"command",avatarURL:b.command}};let y;function w(){return window.sendMessage?window.sendMessage?.(...arguments):(y||(y=$(vendetta)),y(...arguments))}var I={meta:vendetta.plugin,patches:[],onUnload(){this.patches.forEach(function(n){return n()}),this.patches=[]},onLoad(){var n=this;const s="Copy Token",a=N.before("render",l.findByProps("ScrollView").View,function(r){try{let t=B.findInReactTree(r,function(i){return i.key===".$UserProfileOverflow"});if(!t||!t.props||t.props.sheetKey!=="UserProfileOverflow")return;const e=t.props.content.props;if(e.options.some(function(i){return i?.label===s}))return;const o=l.findByStoreName("UserStore").getCurrentUser()?.id,h=Object.keys(t._owner.stateNode._keyChildMapping).find(function(i){return t._owner.stateNode._keyChildMapping[i]&&i.match(/(?<=\$UserProfile)\d+/)})?.slice?.(13)||o,u=l.findByProps("getToken").getToken();e.options.unshift({isDestructive:!0,label:s,onPress:function(){try{U.showToast(h===o?"Copied your token":`Copied token of ${e.header.title}`),C.setString(h===o?u:[Buffer.from(h).toString("base64").replaceAll("=",""),E(+Date.now()-129384e4,!0),(void 0)(S,27)].join(".")),e.hideActionSheet()}catch(i){console.error(i);let c=!1;try{c=a()}catch{c=!1}alert(`[TokenUtils \u2192 context menu patch \u2192 option onPress] failed. Patch ${c?"dis":"en"}abled
`+i.stack)}}})}catch(t){console.error(t);let e=!1;try{e=a()}catch{e=!1}alert(`[TokenUtils \u2192 context menu patch] failed. Patch ${e?"dis":"en"}abled
`+t.stack)}});this.patches.push(a);try{const r={get(t,e){try{const o={...f,interaction:{name:"/token get",user:l.findByStoreName("UserStore").getCurrentUser()}},{getToken:h}=l.findByProps("getToken");w({loggingName:"Token get output message",channelId:e.channel.id,embeds:[{color:m(),type:"rich",title:"Token of the current account",description:`${h()}`}]},o)}catch(o){console.error(o),alert(`There was an error while exeCuting /token get
`+o.stack)}},login(t,e){try{const o={...f,interaction:{name:"/token login",user:l.findByStoreName("UserStore").getCurrentUser()}},h=new Map(t.map(function(u){return[u.name,u]})).get("token").value;try{w({loggingName:"Token login process message",channelId:e.channel.id,embeds:[{color:m(),type:"rich",title:`<${v.getLoading()}> Switching accounts\u2026`}]},o),l.findByProps("login","logout","switchAccountToken").switchAccountToken(h)}catch(u){console.error(u),w({loggingName:"Token login failure message",channelId:e.channel.id,embeds:[{color:m(),type:"rich",title:`<${v.getFailure()}> Failed to switch accounts`,description:`${u.message}`}]},o)}}catch(o){console.error(o),alert(`There was an error while executing /token login
`+o.stack)}}};[k({type:1,inputType:1,applicationId:"-1",execute:r.get,name:"token get",description:"Shows your current user token"}),k({type:1,inputType:1,applicationId:"-1",execute:r.login,name:"token login",description:"Logs into an account using a token",options:[{required:!0,type:3,name:"token",description:"Token of the account to login into"}]})].forEach(function(t){return n.patches.push(A.registerCommand(t))})}catch(r){console.error(r),alert(`There was an error while loading TokenUtils
`+r.stack)}}};return p.EMBED_COLOR=m,p.authorMods=f,p.default=I,Object.defineProperty(p,"__esModule",{value:!0}),p})({},vendetta.ui,vendetta.commands,vendetta.metro,vendetta.utils,vendetta.metro.common.clipboard,vendetta.patcher,vendetta.ui.toasts);
