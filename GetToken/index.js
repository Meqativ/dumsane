(function(p,M,A,l,B,C,N,U){"use strict";function k(e,i,a){if(!e?.name||!e?.description)throw new Error(`No name(${e?.name}) or description(${e?.description}) in the passed command (command name: ${e?.name})`);if(e.displayName??=i?.names?.[a]??e.name,e.displayDescription??=i?.names?.[a]??e.description,e.options){if(!Array.isArray(e.options))throw new Error(`Options is not an array (received: ${typeof e.options})`);for(var t=0;t<e.options.length;t++){const n=e.options[t];if(!n?.name||!n?.description)throw new Error(`No name(${n?.name}) or description(${n?.description} in the option with index ${t}`);if(n.displayName??=i?.options?.[t]?.names?.[a]??n.name,n.displayDescription??=i?.options?.[t]?.descriptions?.[a]??n.description,n?.choices){if(!Array.isArray(n?.choices))throw new Error(`Choices is not an array (received: ${typeof n.choices})`);for(var o=0;o<n.choices.length;o++){const r=n.choices[o];if(!r?.name)throw new Error(`No name of choice with index ${o} in option with index ${t}`);r.displayName??=i?.options?.[t]?.choices?.[o]?.names?.[a]??r.name}}}}return e}function $(e){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:27;if(typeof e!="string")throw new Error("Passed chars isn't a string");if(e?.length<=0)throw new Error("Invalid chars length");let a="";for(let t=0;t<i;t++)a+=e[Math.floor(Math.random()*e.length)];return a}function b(e){const{metro:{findByProps:i,findByStoreName:a,common:{lodash:{merge:t}}}}=e,{sendMessage:o,receiveMessage:n}=i("sendMessage","receiveMessage"),{createBotMessage:r}=i("createBotMessage"),h=i("BOT_AVATARS"),{getChannelId:u}=a("SelectedChannelStore");return function(s,c){if(s.channelId??=u(),[null,void 0].includes(s.channelId))throw new Error("No channel id to receive the message into (channelId)");let d=s;return s.reallySend?(typeof c=="object"&&(d=t(d,c)),o(s.channelId,d)):(c!==!0&&(d=r(d)),typeof c=="object"&&(d=t(d,c),"author"in c&&function(){const g=c.author;["avatar","avatarURL"].every(function(_){return _ in g})&&(h.BOT_AVATARS[g.avatar]=g.avatarURL,delete g.avatarURL)}()),n(d.channel_id,d),d)}}const v={loadingDiscordSpinner:"a:loading:1105495814073229393",aol:"a:aol:1108834296359301161",linuth:":linuth:1110531631409811547",fuckyoy:":fuckyoy:1108360628302782564",getLoading(){return Math.random()<.01?this?.aol:this.loadingDiscordSpinner},getFailure(){return Math.random()<.01?this?.fuckyoy:this.linuth},getSuccess(){return""}},E={command:"https://cdn.discordapp.com/attachments/1099116247364407337/1112129955053187203/command.png"},S="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",T=S.replace("+/","_-");function P(e,i){if(typeof e!="number")throw new Error(`Passed data isn't a number (received: ${typeof e})`);let a="";for(;e>0;)a=(i?T:S).charAt(e%64)+a,e=Math.floor(e/64);return a}const{meta:{resolveSemanticColor:I}}=l.findByProps("colors","meta"),O=l.findByStoreName("ThemeStore"),m=function(){return parseInt(I(O.theme,M.semanticColors.BACKGROUND_SECONDARY).slice(1),16)},f={author:{username:"TokenUtils",avatar:"command",avatarURL:E.command}};let y;function w(){return window.sendMessage?window.sendMessage?.(...arguments):(y||(y=b(vendetta)),y(...arguments))}var R={meta:vendetta.plugin,patches:[],onUnload(){this.patches.forEach(function(e){return e()}),this.patches=[]},onLoad(){var e=this;const i="Copy Token",a=N.before("render",l.findByProps("ScrollView").View,function(t){try{let o=B.findInReactTree(t,function(s){return s.key===".$UserProfileOverflow"});if(!o||!o.props||o.props.sheetKey!=="UserProfileOverflow")return;const n=o.props.content.props;if(n.options.some(function(s){return s?.label===i}))return;const r=l.findByStoreName("UserStore").getCurrentUser()?.id,h=Object.keys(o._owner.stateNode._keyChildMapping).find(function(s){return o._owner.stateNode._keyChildMapping[s]&&s.match(/(?<=\$UserProfile)\d+/)})?.slice?.(13)||r,u=l.findByProps("getToken").getToken();n.options.unshift({isDestructive:!0,label:i,onPress:function(){try{U.showToast(h===r?"Copied your token":`Copied token of ${n.header.title}`),C.setString(h===r?u:[Buffer.from(h).toString("base64").replaceAll("=",""),P(+Date.now()-129384e4,!0),$(T,27)].join(".")),n.hideActionSheet()}catch(s){console.error(s);let c=!1;try{c=a()}catch{c=!1}alert(`[TokenUtils \u2192 context menu patch \u2192 option onPress] failed. Patch ${c?"dis":"en"}abled
`+s.stack)}}})}catch(o){console.error(o);let n=!1;try{n=a()}catch{n=!1}alert(`[TokenUtils \u2192 context menu patch] failed. Patch ${n?"dis":"en"}abled
`+o.stack)}});this.patches.push(a);try{const t={get(o,n){try{const r={...f,interaction:{name:"/token get",user:l.findByStoreName("UserStore").getCurrentUser()}},{getToken:h}=l.findByProps("getToken");w({loggingName:"Token get output message",channelId:n.channel.id,embeds:[{color:m(),type:"rich",title:"Token of the current account",description:`${h()}`}]},r)}catch(r){console.error(r),alert(`There was an error while exeCuting /token get
`+r.stack)}},login(o,n){try{const r={...f,interaction:{name:"/token login",user:l.findByStoreName("UserStore").getCurrentUser()}},h=new Map(o.map(function(u){return[u.name,u]})).get("token").value;try{w({loggingName:"Token login process message",channelId:n.channel.id,embeds:[{color:m(),type:"rich",title:`<${v.getLoading()}> Switching accounts\u2026`}]},r),l.findByProps("login","logout","switchAccountToken").switchAccountToken(h)}catch(u){console.error(u),w({loggingName:"Token login failure message",channelId:n.channel.id,embeds:[{color:m(),type:"rich",title:`<${v.getFailure()}> Failed to switch accounts`,description:`${u.message}`}]},r)}}catch(r){console.error(r),alert(`There was an error while executing /token login
`+r.stack)}}};[k({type:1,inputType:1,applicationId:"-1",execute:t.get,name:"token get",description:"Shows your current user token"}),k({type:1,inputType:1,applicationId:"-1",execute:t.login,name:"token login",description:"Logs into an account using a token",options:[{required:!0,type:3,name:"token",description:"Token of the account to login into"}]})].forEach(function(o){return e.patches.push(A.registerCommand(o))})}catch(t){console.error(t),alert(`There was an error while loading TokenUtils
`+t.stack)}}};return p.EMBED_COLOR=m,p.authorMods=f,p.default=R,Object.defineProperty(p,"__esModule",{value:!0}),p})({},vendetta.ui,vendetta.commands,vendetta.metro,vendetta.utils,vendetta.metro.common.clipboard,vendetta.patcher,vendetta.ui.toasts);
