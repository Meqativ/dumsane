(function(d,C,u,l,f){"use strict";function R(e,r,s){if(!e.name||!e?.description)throw new Error(`No name(${e?.name}) or description(${e?.description}) in the passed command (command name: ${e?.name})`);if(e.displayName??=r?.names?.[s]??e.name,e.displayDescription??=r?.names?.[s]??e.description,e.options){if(!Array.isArray(e.options))throw new Error(`Options is not an array (received: ${typeof e.options})`);for(var o=0;o<e.options.length;o++){const t=e.options[o];if(!t?.name||!t?.description)throw new Error(`No name(${t?.name}) or description(${t?.description} in the option with index ${o}`);if(t.displayName??=r?.options?.[o]?.names?.[s]??t.name,t.displayDescription??=r?.options?.[o]?.descriptions?.[s]??t.description,t?.choices){if(!Array.isArray(t?.choices))throw new Error(`Choices is not an array (received: ${typeof t.choices})`);for(var n=0;n<t.choices.length;n++){const a=t.choices[n];if(!a?.name)throw new Error(`No name of choice with index ${n} in option with index ${o}`);a.displayName??=r?.options?.[o]?.choices?.[n]?.names?.[s]??a.name}}}}return e}function E(e){const{metro:r}=e,{receiveMessage:s}=r.findByProps("sendMessage","receiveMessage"),{createBotMessage:o}=r.findByProps("createBotMessage"),n=r.findByProps("BOT_AVATARS");return function(t,a){if(!t.channelId)throw new Error("No channel id to receive the message into (channelId)");typeof a<"u"&&"author"in a&&"avatar"in a.author&&"avatarURL"in a.author&&(n.BOT_AVATARS[a.author.avatar]=a.author.avatarURL,delete a.author.avatarURL);let c=a===!0?t:o(t);return typeof a=="object"&&(c=e.metro.findByProps("merge").merge(c,a)),s(t.channelId,c),c}}const M={author:{username:"eval",avatar:"command",avatarURL:{command:"https://cdn.discordapp.com/attachments/1099116247364407337/1112129955053187203/command.png"}.command}},N=async function(){}.constructor;"stats"in l.storage||(l.storage.stats={});{const e=l.storage.stats;"runs"in e||(e.runs={failed:0,succeeded:0})}const{meta:{resolveSemanticColor:v}}=u.findByProps("colors","meta"),g=u.findByStoreName("ThemeStore"),h=function(e){parseInt(v(g.theme,f.semanticColors.BACKGROUND_SECONDARY).slice(1),16)};let y;function w(){return window.sendMessage?window.sendMessage?.(...arguments):(y||(y=E(vendetta)),y(...arguments))}const A={meta:vendetta.plugin,onLoad(){try{this.onUnload=C.registerCommand(R({type:1,inputType:1,applicationId:"-1",name:"!eval",displayName:"!eval",description:"Evaluates code",options:[{required:!0,type:3,name:"code",description:"Code to evaluate"},{type:4,name:"type",description:"Type of the code",choices:[{name:"sync",value:0},{name:"async [default]",value:1}]},{type:5,name:"return",description:"Return the returned value? (so it works as a real command, default: false)"},{type:5,name:"global",description:"Evaluate the code in the global scope? (default: false)"},{type:5,name:"silent",description:"Show the output of the evaluation? (default: false)"}],async execute(e,r){const s={...M,interaction:{name:"/eval",user:u.findByStoreName("UserStore").getCurrentUser()}},o={messageMods:s,...r,args:new Map(e.map(function(n){return[n.name,n]})),plugin:this};try{const{channel:n,args:t}=o,a=t.get("type")?.value,c=t.get("silent")?.value??!1,S=t.get("global")?.value??!1,m=t.get("code")?.value;let i,p;const $=new(a?N:Function)(m);let O=+new Date;try{i=await(S?$():$.bind(o)())}catch(D){i=D,p=!0}let B=+new Date-O;if(c||(p&&w({channelId:n.id,embeds:[{type:"rich",color:h("exploded"),description:l.storage.trimError?i.stack.split(`
    at next (native)`)[0]:i.stack,footer:{text:`type: ${typeof i}
took: ${B}ms`}}]},{...s,rawCode:m}),p||w({channelId:n.id,content:`\`\`\`js
${vendetta.metro.findByProps("inspect").inspect(i)}\`\`\``,embeds:[{type:"rich",color:h("satisfactory"),footer:{text:`type: ${typeof i}
`+(typeof i>"u"&&!m.includes("return")?`hint: use the return keyword
`:"")`took: ${B}ms`}}]},{...s,rawCode:m})),!p&&t.get("return")?.value)return i}catch(n){console.error(n),alert(`An uncatched error was thrown while running /eval
`+n.stack)}}}))}catch(e){console.error(e),alert(`There was an error while loading the plugin "${A.meta.name}"
${e.stack}`)}}};return d.EMBED_COLOR=h,d.default=A,Object.defineProperty(d,"__esModule",{value:!0}),d})({},vendetta.commands,vendetta.metro,vendetta.plugin,vendetta.ui);
